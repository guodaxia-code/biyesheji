<!DOCTYPE html>
<html lang="en" xmlns:th="http:www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>分类管理</title>
    <link rel="stylesheet" href="/store/static/layui/css/layui.css">

    <style>
        table,th ,td ,tr{
            /*text-align: center;*/
            border: 1px solid #ccc;
        }
        table {
            margin: 20px auto;
        }
    </style>

</head>
<body>





    <div class="layui-btn-group">
        <button type="button" class="layui-btn">增加</button>
        <button type="button" class="layui-btn">编辑</button>
        <button type="button" class="layui-btn">删除</button>
    </div>



<!--    <table  class="layui-table" lay-data="{height: 'full-100',size:'lg', loading:'false', url:'/store/category/findAllByLayui', page:true, id:'test'}" lay-filter="test">-->
<!--        <thead>-->
<!--        <tr>-->
<!--            <th><input type="checkbox"></th>-->
<!--            <th lay-data="{field:'cid'}">Cid</th>-->
<!--            <th lay-data="{field:'cname'}">分类名称</th>-->
<!--            <th lay-data="{field:'hot', sort: true}">热度</th>-->
<!--            <th lay-data="{field:'picture'}">图片</th>-->
<!--            <th lay-data="{field:'操作'}">操作-->

<!--                <div class="layui-btn-group">-->
<!--                    <button type="button" class="layui-btn layui-btn-primary layui-btn-sm">-->
<!--                        <i class="layui-icon">123</i>-->
<!--                    </button>-->
<!--                    <button type="button" class="layui-btn layui-btn-primary layui-btn-sm">-->
<!--                        <i class="layui-icon">12</i>-->
<!--                    </button>-->
<!--                    <button type="button" class="layui-btn layui-btn-primary layui-btn-sm">-->
<!--                        <i class="layui-icon">1</i>-->
<!--                    </button>-->
<!--                </div>-->
<!--            </th>-->

<!--        </tr>-->
<!--        </thead>-->
<!--    </table>-->



<!--    <table>
        <thead>
            <tr>
                <th>分类名称</th>
                <th>是否热门</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody id="tbody">
            <tr th:each="category:${categorys}">
                <td><span th:text="${category.cname}"></span></td>
                <td><span th:text="${category.hot}"></span></td>
                <td><button  th:cid="${category.cid}">删除</button></td>
             </tr>
        </tbody>
    </table>-->

    <div class="layui-card-body ">
        <table id="category" class="layui-table" layui-filter="category" lay-filter="category"></table>
    </div>


    <button>fdsgfd</button>


    <script src="/store/static/mystore/js/jquery-3.3.1.js"></script>
    <script src="/store/static/layui/layui.js"></script>


    <script>


        // layui.table.exportFile(id, data, type)
        // var checkStatus = layui.table.checkStatus('test'); //idTest 即为基础参数 id 对应的值
        //
        // $("#add").click(function () {
        //     console.log(checkStatus.data) //获取选中行的数据
        //     console.log(checkStatus.data.length) //获取选中行数量，可作为是否有选中行的条件
        //     console.log(checkStatus.isAll ) //表格是否全选
        // })

            var tables;  //对表格进行重载
            layui.use(['table','layer'], function () {
                var layer = layui.layer; tables=layui.table;
                tables=tables.render({
                    elem:"#category",
                    url:'/store/category/findAllByLayui',
                    page:true,
                    height: 'full-100',
                    size:'lg',
                    loading:'false',
                    // totalRow:true,
                    cellMinWidth: 30,
                    limits:[10,20,30],

                    cols:[[
                        {type : "checkbox"},
                        {title:'序号',type:'numbers',align:'center'},
                        ,{field: 'cname', title: '分类名称'}
                        ,{field: 'picture', title: '图片'}
                        ,{field: 'hot', title: '热度', sort: true},
                        { fixed: 'right', title: '操作', width: 215, align:'center', toolbar: '#bar'  }
                    ]]
                })


                //监听工具条
                layui.table.on('tool(category)', function(obj){ //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
                    var data = obj.data; //获得当前行数据
                    console.log(data)
                    var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
                    var tr = obj.tr; //获得当前行 tr 的 DOM 对象（如果有的话）

                    if(layEvent === 'detail'){ //查看
                        console.log("kan")
                        console.log("投诉详情");
                        var index = layer.open({
                            type: 2,
                            title: "分类详情页面",
                            area: ['30%', '60%'],
                            fix: false,
                            maxmin: true,
                            shadeClose: true,
                            shade: 0.4,
                            skin: 'layui-layer-rim',
                            content: ["/store/category/findOneCategory?cid="+data.cid, "no"],

                        });


                        //do somehing
                    } else if(layEvent === 'del'){ //删除
                        layer.confirm('真的删除行么', function(index){
                            obj.del(); //删除对应行（tr）的DOM结构，并更新缓存
                            layer.close(index);
                            //向服务端发送删除指令
                            $.get("/store/admin/update/"+data.cid,
                                function (data) {
                                    console.log("sucessaaaaaaaaaaaaaa")
                                }
                            );

                        });
                    } else if(layEvent === 'edit'){ //编辑
                        //do something



                        var index = layer.open({
                            type: 2,
                            title: "分类修改页面",
                            area: ['30%', '60%'],
                            fix: false,
                            maxmin: true,
                            shadeClose: true,
                            shade: 0.4,
                            skin: 'layui-layer-rim',
                            content: ["/store/category/updateOneCategory?cid="+data.cid, "no"],

                        });

                        //同步更新缓存对应的值
                        obj.update({
                            username: '123'
                            ,title: 'xxx'
                        });
                    } else if(layEvent === 'LAYTABLE_TIPS'){
                        layer.alert('Hi，头部工具栏扩展的右侧图标。');
                    }
                });


            })



        // var checkStatus = tables.checkStatus('idTest'); //idTest 即为基础参数 id 对应的值
        //
        // console.log(checkStatus.data) //获取选中行的数据
        // console.log(checkStatus.data.length) //获取选中行数量，可作为是否有选中行的条件
        // console.log(checkStatus.isAll ) //表格是否全选


















    </script>

    /*操作按钮*/
    <script type="text/html" id="bar">
        <div class="layui-btn-group">
<!--            <button type="button" class="layui-btn layui-btn-sm">
                <i class="layui-icon">&#xe654;</i>
            </button>-->


            <button type="button" class="layui-btn layui-btn-sm" lay-event="detail">
                <i class="layui-icon">查看</i>
            </button>
            <button type="button" class="layui-btn layui-btn-sm" lay-event="edit">
                <i class="layui-icon">&#xe642;</i>
            </button>
            <button type="button" class="layui-btn layui-btn-sm" lay-event="del">
                <i class="layui-icon">&#xe640;</i>
            </button>
<!--            <button type="button" class="layui-btn layui-btn-sm">-->
<!--                <i class="layui-icon">&#xe602;</i>-->
<!--            </button>-->
        </div>

    </script>

    /*分类操作js*/
<!--    <script>
        function delCategory(){

            var flag=confirm("你确定要删除吗？");
            if (flag){
                $.get("/store/admin/update/"+this.getAttribute("cid"),
                    function (data) {
                        console.log("sucessaaaaaaaaaaaaaa")
                        location.reload();
                    }
                );
            }

        }
        window.onload=function (ev) {
            var tbody = document.getElementById("tbody");
            var buttons = tbody.getElementsByTagName("button");
            for (var i=0;i<buttons.length;i++){
                buttons[i].onclick=delCategory;
            }

        }
    </script>-->




</body>
</html>